<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>HighRoll Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #1e1e1e;
      color: #ffffff;
    }

    h1,
    h2,
    h3 {
      color: #0078d4;
    }

    button {
      background-color: #0078d4;
      color: white;
      border: none;
      padding: 10px 15px;
      margin: 10px 5px 10px 0;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #005a9e;
    }

    .info {
      margin-top: 20px;
      padding: 15px;
      background-color: #2d2d2d;
      border-radius: 4px;
    }

    .shortcut {
      display: inline-block;
      background-color: #333;
      padding: 3px 6px;
      border-radius: 3px;
      margin: 0 2px;
    }

    .status {
      margin-top: 20px;
      padding: 10px;
      border-radius: 4px;
      background-color: #2d2d2d;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-on {
      background-color: #00d084;
    }

    .status-off {
      background-color: #666;
    }

    .control-group {
      margin: 15px 0;
      padding: 15px;
      background-color: #2d2d2d;
      border-radius: 4px;
    }

    .control-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .control-label {
      width: 150px;
      margin-right: 10px;
    }

    .slider-container {
      flex-grow: 1;
      display: flex;
      align-items: center;
    }

    .slider {
      flex-grow: 1;
      margin-right: 10px;
    }

    .slider-value {
      width: 50px;
      text-align: center;
    }

    .number-input {
      width: 60px;
      padding: 5px;
      margin-right: 10px;
      background-color: #333;
      color: white;
      border: 1px solid #555;
      border-radius: 3px;
    }

    .game-state-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .game-state-section {
      flex: 1;
      min-width: 250px;
      background-color: #2d2d2d;
      border-radius: 4px;
      padding: 15px;
      margin-top: 20px;
    }

    .game-state-row {
      display: flex;
      margin-bottom: 10px;
    }

    .game-state-label {
      width: 100px;
      margin-right: 10px;
    }

    .game-state-value {
      flex-grow: 1;
    }

    .champion-item {
      background-color: #333;
      padding: 8px;
      margin-bottom: 5px;
      border-radius: 4px;
      display: flex;
      justify-content: space-between;
    }

    .champion-cost-1 {
      border-left: 3px solid #cccccc;
    }

    .champion-cost-2 {
      border-left: 3px solid #11b288;
    }

    .champion-cost-3 {
      border-left: 3px solid #207ac7;
    }

    .champion-cost-4 {
      border-left: 3px solid #c440da;
    }

    .champion-cost-5 {
      border-left: 3px solid #ffb93b;
    }

    .trait-active {
      color: #00d084;
    }

    .trait-inactive {
      color: #999;
    }

    .augment-tier-1 {
      color: #11b288;
    }

    .augment-tier-2 {
      color: #207ac7;
    }

    .augment-tier-3 {
      color: #ffb93b;
    }
  </style>
</head>

<body>
  <h1>HighRoll TFT Overlay Test</h1>

  <div>
    <button id="toggleOverlay">Toggle Overlay</button>
    <button id="toggleClickThrough">Toggle Click-Through</button>
  </div>

  <div class="status">
    <p>
      <span class="status-indicator" id="overlayStatus"></span>
      Overlay: <span id="overlayStatusText">Hidden</span>
    </p>
    <p>
      <span class="status-indicator" id="clickThroughStatus"></span>
      Click-Through: <span id="clickThroughStatusText">Disabled</span>
    </p>
  </div>

  <div class="control-group">
    <h3>Overlay Controls</h3>

    <div class="control-row">
      <div class="control-label">Transparency:</div>
      <div class="slider-container">
        <input type="range" min="0.1" max="1" step="0.05" value="0.8" class="slider" id="opacitySlider">
        <span class="slider-value" id="opacityValue">0.8</span>
      </div>
    </div>

    <div class="control-row">
      <div class="control-label">Size:</div>
      <div class="slider-container">
        <label for="widthInput">Width:</label>
        <input type="number" id="widthInput" class="number-input" value="400" min="200" max="1000">
        <label for="heightInput">Height:</label>
        <input type="number" id="heightInput" class="number-input" value="300" min="150" max="800">
        <button id="resizeBtn">Resize</button>
      </div>
    </div>
  </div>

  <div class="control-group">
    <h3>Game State Simulator</h3>

    <div class="control-row">
      <div class="control-label">Stage:</div>
      <div class="slider-container">
        <select id="stageSelect" class="number-input" style="width: 120px;">
          <option value="carousel">Carousel</option>
          <option value="planning">Planning</option>
          <option value="combat">Combat</option>
          <option value="augment">Augment Selection</option>
        </select>
        <button id="updateStageBtn">Update</button>
      </div>
    </div>

    <div class="control-row">
      <div class="control-label">Round:</div>
      <div class="slider-container">
        <input type="number" id="roundInput" class="number-input" value="1" min="1" max="50">
        <button id="updateRoundBtn">Update</button>
      </div>
    </div>

    <div class="control-row">
      <div class="control-label">Health:</div>
      <div class="slider-container">
        <input type="range" min="1" max="100" value="100" class="slider" id="healthSlider">
        <span class="slider-value" id="healthValue">100</span>
        <button id="updateHealthBtn">Update</button>
      </div>
    </div>

    <div class="control-row">
      <div class="control-label">Gold:</div>
      <div class="slider-container">
        <input type="range" min="0" max="100" value="50" class="slider" id="goldSlider">
        <span class="slider-value" id="goldValue">50</span>
        <button id="updateGoldBtn">Update</button>
      </div>
    </div>

    <div class="control-row">
      <div class="control-label">Level:</div>
      <div class="slider-container">
        <input type="range" min="1" max="10" value="1" class="slider" id="levelSlider">
        <span class="slider-value" id="levelValue">1</span>
        <button id="updateLevelBtn">Update</button>
      </div>
    </div>
  </div>

  <div class="game-state-container">
    <div class="game-state-section">
      <h3>Current Game State</h3>
      <div id="gameStateDisplay">
        <p>Loading game state...</p>
      </div>
    </div>
  </div>

  <div class="info">
    <h3>Keyboard Shortcuts:</h3>
    <p><span class="shortcut">Alt</span> + <span class="shortcut">Shift</span> + <span class="shortcut">O</span> -
      Toggle overlay visibility</p>
    <p><span class="shortcut">Alt</span> + <span class="shortcut">Shift</span> + <span class="shortcut">C</span> -
      Toggle click-through mode</p>
  </div>

  <script>
    const { ipcRenderer } = require('electron');

    // Get buttons and status elements
    const toggleOverlayBtn = document.getElementById('toggleOverlay');
    const toggleClickThroughBtn = document.getElementById('toggleClickThrough');
    const overlayStatus = document.getElementById('overlayStatus');
    const overlayStatusText = document.getElementById('overlayStatusText');
    const clickThroughStatus = document.getElementById('clickThroughStatus');
    const clickThroughStatusText = document.getElementById('clickThroughStatusText');

    // Get opacity controls
    const opacitySlider = document.getElementById('opacitySlider');
    const opacityValue = document.getElementById('opacityValue');

    // Get size controls
    const widthInput = document.getElementById('widthInput');
    const heightInput = document.getElementById('heightInput');
    const resizeBtn = document.getElementById('resizeBtn');

    // Get game state controls
    const stageSelect = document.getElementById('stageSelect');
    const updateStageBtn = document.getElementById('updateStageBtn');
    const roundInput = document.getElementById('roundInput');
    const updateRoundBtn = document.getElementById('updateRoundBtn');
    const healthSlider = document.getElementById('healthSlider');
    const healthValue = document.getElementById('healthValue');
    const updateHealthBtn = document.getElementById('updateHealthBtn');
    const goldSlider = document.getElementById('goldSlider');
    const goldValue = document.getElementById('goldValue');
    const updateGoldBtn = document.getElementById('updateGoldBtn');
    const levelSlider = document.getElementById('levelSlider');
    const levelValue = document.getElementById('levelValue');
    const updateLevelBtn = document.getElementById('updateLevelBtn');

    // Get game state display
    const gameStateDisplay = document.getElementById('gameStateDisplay');

    // Initialize status indicators
    overlayStatus.classList.add('status-off');
    clickThroughStatus.classList.add('status-off');

    // Initialize game state
    let currentGameState = null;

    // Add event listeners for overlay controls
    toggleOverlayBtn.addEventListener('click', () => {
      ipcRenderer.send('toggle-overlay');
    });

    toggleClickThroughBtn.addEventListener('click', () => {
      ipcRenderer.send('toggle-click-through');
    });

    // Add event listeners for opacity controls
    opacitySlider.addEventListener('input', () => {
      const opacity = parseFloat(opacitySlider.value);
      opacityValue.textContent = opacity.toFixed(2);
      ipcRenderer.send('set-overlay-transparency', opacity);
    });

    // Add event listeners for size controls
    resizeBtn.addEventListener('click', () => {
      const width = parseInt(widthInput.value);
      const height = parseInt(heightInput.value);
      ipcRenderer.send('resize-overlay', width, height);
    });

    // Add event listeners for game state controls
    updateStageBtn.addEventListener('click', () => {
      ipcRenderer.send('update-game-state', { stage: stageSelect.value });
    });

    updateRoundBtn.addEventListener('click', () => {
      ipcRenderer.send('update-game-state', { round: parseInt(roundInput.value) });
    });

    healthSlider.addEventListener('input', () => {
      healthValue.textContent = healthSlider.value;
    });

    updateHealthBtn.addEventListener('click', () => {
      ipcRenderer.send('update-game-state', { health: parseInt(healthSlider.value) });
    });

    goldSlider.addEventListener('input', () => {
      goldValue.textContent = goldSlider.value;
    });

    updateGoldBtn.addEventListener('click', () => {
      ipcRenderer.send('update-game-state', { gold: parseInt(goldSlider.value) });
    });

    levelSlider.addEventListener('input', () => {
      levelValue.textContent = levelSlider.value;
    });

    updateLevelBtn.addEventListener('click', () => {
      ipcRenderer.send('update-game-state', { level: parseInt(levelSlider.value) });
    });

    // Listen for overlay visibility changes
    ipcRenderer.on('overlay-visibility-changed', (event, isVisible) => {
      if (isVisible) {
        overlayStatus.classList.remove('status-off');
        overlayStatus.classList.add('status-on');
        overlayStatusText.textContent = 'Visible';
      } else {
        overlayStatus.classList.remove('status-on');
        overlayStatus.classList.add('status-off');
        overlayStatusText.textContent = 'Hidden';
      }
    });

    // Listen for click-through changes
    ipcRenderer.on('click-through-changed', (event, isEnabled) => {
      if (isEnabled) {
        clickThroughStatus.classList.remove('status-off');
        clickThroughStatus.classList.add('status-on');
        clickThroughStatusText.textContent = 'Enabled';
      } else {
        clickThroughStatus.classList.remove('status-on');
        clickThroughStatus.classList.add('status-off');
        clickThroughStatusText.textContent = 'Disabled';
      }
    });

    // Listen for opacity changes
    ipcRenderer.on('overlay-opacity-changed', (event, opacity) => {
      opacitySlider.value = opacity;
      opacityValue.textContent = opacity.toFixed(2);
    });

    // Listen for size changes
    ipcRenderer.on('overlay-size-changed', (event, size) => {
      widthInput.value = size.width;
      heightInput.value = size.height;
    });

    // Listen for game state updates
    ipcRenderer.on('game-state-updated', (event, gameState) => {
      currentGameState = gameState;
      updateGameStateDisplay();

      // Update UI controls to match game state
      stageSelect.value = gameState.stage;
      roundInput.value = gameState.round;
      healthSlider.value = gameState.health;
      healthValue.textContent = gameState.health;
      goldSlider.value = gameState.gold;
      goldValue.textContent = gameState.gold;
      levelSlider.value = gameState.level;
      levelValue.textContent = gameState.level;
    });

    // Function to update game state display
    function updateGameStateDisplay() {
      if (!currentGameState) return;

      let html = `
        <div class="game-state-row">
          <div class="game-state-label">Stage:</div>
          <div class="game-state-value">${currentGameState.stage}</div>
        </div>
        <div class="game-state-row">
          <div class="game-state-label">Round:</div>
          <div class="game-state-value">${currentGameState.round}</div>
        </div>
        <div class="game-state-row">
          <div class="game-state-label">Health:</div>
          <div class="game-state-value">${currentGameState.health}</div>
        </div>
        <div class="game-state-row">
          <div class="game-state-label">Gold:</div>
          <div class="game-state-value">${currentGameState.gold}</div>
        </div>
        <div class="game-state-row">
          <div class="game-state-label">Level:</div>
          <div class="game-state-value">${currentGameState.level}</div>
        </div>

        <h4>Champions</h4>
      `;

      if (currentGameState.champions && currentGameState.champions.length > 0) {
        currentGameState.champions.forEach(champion => {
          html += `
            <div class="champion-item champion-cost-${champion.cost}">
              <div>${champion.name} (${champion.stars}★)</div>
              <div>Cost: ${champion.cost}</div>
            </div>
          `;
        });
      } else {
        html += '<p>No champions</p>';
      }

      html += '<h4>Traits</h4>';

      if (currentGameState.traits && currentGameState.traits.length > 0) {
        currentGameState.traits.forEach(trait => {
          html += `
            <div class="champion-item ${trait.active ? 'trait-active' : 'trait-inactive'}">
              <div>${trait.name}</div>
              <div>Count: ${trait.count}</div>
            </div>
          `;
        });
      } else {
        html += '<p>No traits</p>';
      }

      html += '<h4>Augments</h4>';

      if (currentGameState.augments && currentGameState.augments.length > 0) {
        currentGameState.augments.forEach(augment => {
          html += `
            <div class="champion-item augment-tier-${augment.tier}">
              <div>${augment.name}</div>
              <div>Tier: ${augment.tier}</div>
            </div>
          `;
        });
      } else {
        html += '<p>No augments</p>';
      }

      gameStateDisplay.innerHTML = html;
    }

    // Initialize by getting current values
    async function initialize() {
      try {
        // Get current opacity
        const opacity = await ipcRenderer.invoke('get-overlay-opacity');
        opacitySlider.value = opacity;
        opacityValue.textContent = opacity.toFixed(2);

        // Get current size
        const [width, height] = await ipcRenderer.invoke('get-overlay-size');
        widthInput.value = width;
        heightInput.value = height;

        // Get current game state
        const gameState = await ipcRenderer.invoke('get-game-state');
        if (gameState) {
          currentGameState = gameState;
          updateGameStateDisplay();

          // Update UI controls to match game state
          stageSelect.value = gameState.stage;
          roundInput.value = gameState.round;
          healthSlider.value = gameState.health;
          healthValue.textContent = gameState.health;
          goldSlider.value = gameState.gold;
          goldValue.textContent = gameState.gold;
          levelSlider.value = gameState.level;
          levelValue.textContent = gameState.level;
        }

        // Check if overlay is visible
        const isVisible = await ipcRenderer.invoke('get-overlay-visibility');
        if (isVisible) {
          overlayStatus.classList.remove('status-off');
          overlayStatus.classList.add('status-on');
          overlayStatusText.textContent = 'Visible';
        }

        // Check if click-through is enabled
        const isClickThrough = await ipcRenderer.invoke('get-click-through-state');
        if (isClickThrough) {
          clickThroughStatus.classList.remove('status-off');
          clickThroughStatus.classList.add('status-on');
          clickThroughStatusText.textContent = 'Enabled';
        }
      } catch (error) {
        console.error('Error initializing:', error);
      }
    }

    // Initialize the UI
    initialize();
  </script>
</body>

</html>